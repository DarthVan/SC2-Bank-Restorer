import{a as M,R,o as T,u as w,r,m as S,M as K,b,d as _,c as j,j as d,C as N,L as H,I as E,E as P}from"./index-BFMbvnWS.js";import{e as F,f as L,g as D,h as o,d as l,B}from"./index-CJ2JAY71.js";/*!
 * sc2-bank-generator v.1.1.8
 *
 * Compiled from:
 *
 * sc2-bank-generator/src/components/maps/mineralz-survaival-classic/store.ts
 * sc2-bank-generator/src/components/maps/mineralz-survaival-classic/functions.ts
 * sc2-bank-generator/src/components/maps/mineralz-survaival-classic/index.tsx
 *
 * Ð¡ompiled on Mon, 09 Sep 2024 16:40:08 UTC
 */class W{constructor(){this.init(),M(this)}setFields(e){this.params=e?[...e]:[]}updateAt(e,t,u){if(u){this.params[e].value=t;return}const c=[...this.params];c[e].value=t,this.params=c}reset(){this.init()}init(){this.params=[{type:"number",value:1e4,description:"Experience",min:0,max:1e5,tip:"0 - 100000"},{type:"number",value:1e3,description:"Games",min:0,max:1e4,tip:"0 - 10000"},{type:"number",value:100,description:"Level",min:1,max:500,tip:"1 - 500"},{type:"number",value:1e4,description:"Kills",min:1,max:999999,tip:"1 - 999999"},{type:"number",value:1e3,description:"Wins",min:0,max:5e3,tip:"0 - 5000"},{type:"number",value:50,description:"Easy",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:50,description:"Normal",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:50,description:"Hard",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:50,description:"Insane",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:50,description:"Hell",min:0,max:1e3,tip:"0 - 1000"}]}}const i=new W;class X{generateXML(e){const t=parseInt(e.info.playerID.substring(8)),u=.181;e.addKey("version","FIXED",u,"sec");const c=i.params[0].value||0;c>0&&e.addKey("Experience","FIXED",c,"sec");const m=i.params[1].value||0;m>0&&e.addKey("Games","INT",m,"sec");const g=i.params[2].value||0;g>0&&e.addKey("Level","INT",g,"sec");const h=i.params[3].value||0;h>0&&e.addKey("Kills","INT",h,"sec");const v=i.params[4].value||0;v>0&&e.addKey("Wins","INT",v,"sec");const f=i.params[5].value||0;f>0&&e.addKey("NightsEasy","INT",f,"sec");const p=i.params[6].value||0;p>0&&e.addKey("NightsNormal","INT",p,"sec");const y=i.params[7].value||0;y>0&&e.addKey("NightsHard","INT",y,"sec");const n=i.params[8].value||0;n>0&&e.addKey("NightsInsane","INT",n,"sec");const x=i.params[9].value||0;x>0&&e.addKey("NightsHell","INT",x,"sec");const s={exp:c,games:m,level:g,kills:h,wins:v,easy:f,normal:p,hard:y,insane:n,hell:x},a=this.stupidProtection(t,s)+u;e.addKey("CheatProtection1","FIXED",a,"sec");const C=F(L(D(o(this.stupidProtection(t,s)),1e4)),1e3)-u;return e.addKey("CheatProtection2","FIXED",C,"sec"),e.updateSignature(),e.getAsString()}parse(e,t){return e.parse(t),e.sections.size!=1||e.sections.get("sec")==null?(console.error("Wrong bank file!"),null):[{type:"number",value:this.getKey(e,"Experience"),description:"Experience",min:0,max:1e5,tip:"0 - 100000"},{type:"number",value:this.getKey(e,"Games"),description:"Games",min:0,max:1e4,tip:"0 - 10000"},{type:"number",value:this.getKey(e,"Level"),description:"Level",min:0,max:500,tip:"0 - 500"},{type:"number",value:this.getKey(e,"Kills"),description:"Kills",min:0,max:999999,tip:"0 - 999999"},{type:"number",value:this.getKey(e,"Wins"),description:"Wins",min:0,max:5e3,tip:"0 - 5000"},{type:"number",value:this.getKey(e,"NightsEasy"),description:"Easy",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:this.getKey(e,"NightsNormal"),description:"Normal",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:this.getKey(e,"NightsHard"),description:"Hard",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:this.getKey(e,"NightsInsane"),description:"Insane",min:0,max:1e3,tip:"0 - 1000"},{type:"number",value:this.getKey(e,"NightsHell"),description:"Hell",min:0,max:1e3,tip:"0 - 1000"}]}getKey(e,t){const u=e.getKey(t,"sec");return u?parseInt(u.value):0}stupidProtection(e,t){return F(L(D(l(D(l(t.exp+1,o(30)),l(t.games+2,o(29)),l(t.level+3,o(23)),l(t.kills+4,o(19)),l(t.wins+5,o(17)),l(t.easy+.5,o(13)),l(t.normal+1.5,o(11)),l(t.hard+2.5,o(7)),l(t.insane+3.5,o(5)),l(t.hell+4.5,o(3)),l(e,65537)),o(3)),1e4)),1e3)}}const A=new X,V=T(I=>{const{accountStore:e,menuStore:t,mapStore:u,modalStore:c}=w(),[m,g]=r.useState(I.bankName),[h,v]=r.useState(S.get(K.MINERALZ_SURVAIVAL_CLASSIC).authorID),f=S.get(K.MINERALZ_SURVAIVAL_CLASSIC).title,p=r.useMemo(()=>new B(m,h,t.playerID,"1"),[e.current,t.playerID,m,h]),y=()=>{u.setMapData(e.current,f,i.params)};r.useEffect(()=>{var a;const s=(a=u.list[e.current])==null?void 0:a[f];s?i.setFields(s):setTimeout(n.onResetClick)},[e.current]);const n={onBankNameChange:r.useCallback(s=>{g(s)},[]),onAuthorIdChange:r.useCallback(s=>{v(s)},[]),onFileDrop:r.useCallback((s,a)=>{const C=A.parse(p,a);C&&(b.flushSync(()=>i.setFields()),i.setFields(C))},[]),onDownloadClick:r.useCallback(()=>{if(t.playerID.split("-").length!=4){c.setModal("WARN","This map requires a player id to generate valid bank! Use Help for details.");return}_(A.generateXML(p),m+".SC2Bank"),t.autoSave||y()},[p]),onCopyCodeClick:r.useCallback(()=>{if(t.playerID.split("-").length!=4){c.setModal("WARN","This map requires a player id to generate valid bank! Use Help for details.");return}j(A.generateXML(p)),t.autoSave||y()},[p]),onResetClick:r.useCallback(()=>{g(I.bankName),v(S.get(K.MINERALZ_SURVAIVAL_CLASSIC).authorID),b.flushSync(()=>i.setFields()),i.reset()},[]),onFieldChange:r.useCallback((s,a)=>{i.updateAt(a,parseInt(s),!0),t.autoSave&&y()},[])},x=r.useMemo(()=>d.jsxs(N,{style:{flexDirection:"column"},children:[d.jsx(H,{children:"Main stats and nights:"}),d.jsxs(N,{style:{flexDirection:"row"},children:[d.jsx(N,{style:{flexDirection:"column",border:"1px solid #ffffff40",padding:"10px"},alignInputs:!0,children:i.params.map((s,a)=>a<5?d.jsx(E,{index:a,type:"number",style:{width:"50px"},label:s.description+":",onChange:n.onFieldChange,min:s.min.toString(),max:s.max.toString(),value:s.value.toString(),tip:s.tip?s.tip:null},a):null)}),d.jsx(N,{style:{flexDirection:"column",border:"1px solid #ffffff40",padding:"10px"},alignInputs:!0,children:i.params.map((s,a)=>a>=5?d.jsx(E,{index:a,type:"number",style:{width:"50px"},label:s.description+":",onChange:n.onFieldChange,min:s.min.toString(),max:s.max.toString(),value:s.value.toString(),tip:s.tip?s.tip:null},a):null)})]})]}),[i.params]);return d.jsx(P,{bankName:m,authorID:h,onBankNameChange:n.onBankNameChange,onAuthorIdChange:n.onAuthorIdChange,onFileDrop:n.onFileDrop,onDownload:n.onDownloadClick,onCopy:n.onCopyCodeClick,onReset:n.onResetClick,children:x})}),G=R.memo(V);export{G as default};
